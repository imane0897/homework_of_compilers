# 递归下降分析子程序

## 实验要求

1. 将文法保存为文本文件形式，每行一条产生式，消除文法左递归。
2. 实现递归下降分析。

## 设计

1. 消除文法左递归

   1. 按产生式左边的文法符号的字典序对产生式进行排序
   2. 用代入法将间接和潜在左递归转换为直接左递归：将第 j 个产生式右边的非终结符号N替换为N的排在第 i 位（i < j）的候选式。如果N有n个候选式，需要把每个候选式都使用一次。
   3. 消除直接左递归，对于形如 A :: Aa1|…|Aan|b1|…bn的产生式（bi不以A开头），将其修改为 A :: b1A'|…|bmA', A' :: a1A'|…|anA'|#

2. 递归下降分析

   为每个非终结符号设计一个处理过程，递归调用。

   ## 主要数据结构和算法

   1. class Grammar()定义了一个文法的数据结构，包含开始符合(start)、非终结符号(variables)、终结符号(terminals)、产生式(productions)。
   2. 文法以字符串的形式读入。
      1. 第一行产生式左边的非终结符号为开始符号；
      2. 非终结符号为所有出现在产生式左边的符号；
      3. 先将所有的出现在产生式右边的符号加入终结符号的列表，记录完全部的非终结符号后，再将非终结符号移除，剩余的则是终结符号。

   ## 流程

   1. 给定一个文法并初始化
   2. 消除文法的左递归。
      1. 排序
      2. 将间接和潜在左递归转换为直接左递归
      3. 消除直接左递归
   3. 从文件读入一个字符串
   4. 用穷举试探和之后进行递归调用的策略对字符串进行递归下降分析

## 测试样例

### 消除左递归

```python
    g = \
'''E :: E + T | T
T :: T * F | F
F :: ( E ) | i'''
```

g  是保存了一个文法的字符串，每个符号之间有一个空格，产生式的左右两边用 :: 隔开。

![屏幕快照 2017-01-01 上午10.52.54](/Users/AnYameng/Desktop/屏幕快照 2017-01-01 上午10.52.54.png)

```python
    g = \
'''S :: A | b
A :: A c | S d'''
```

![屏幕快照 2017-01-01 上午10.21.38](/Users/AnYameng/Desktop/屏幕快照 2017-01-01 上午10.21.38.png)

### 递归下降分析

1. 输入

   ```
   (i+i)
   i*(i+i)
   i+a
   (i+i)*(i+i)
   i*(i+
   ```

2. 输出

```
(i+i)      	:   legal

i*(i+i)       	:   legal

i+a          	:   illegal

(i+i)*(i+i)    	:   legal

i*(i+   	:   illegal
```

## 体会

递归下降分析实现起来比较简单，但是需要消除左递归和克服回溯，否则效率会很低。